/**
 * @license
 * Copyright (c) 2014, 2022, Oracle and/or its affiliates.
 * Licensed under The Universal Permissive License (UPL), Version 1.0
 * as shown at https://oss.oracle.com/licenses/upl/
 * @ignore
 */
define(["exports","ojs/ojdvt-toolkit"],function(t,n){"use strict";class i extends n.EventManager{constructor(t,n,i){super(t,n,i),this._MOMENTUM_START_TIMER_INTERVAL=50,this._pzc=i,this._zoomAnimator=null,this._bPanning=!1,this._bPanned=!1,this._bZooming=!1,this._bDragging=!1,this._bMomentumPanning=!0}addListeners(t){super.addListeners(t),t.addEvtListener(n.MouseEvent.MOUSEWHEEL,this.OnMouseWheel,!1,this)}RemoveListeners(t){super.RemoveListeners(t),t.removeEvtListener(n.MouseEvent.MOUSEWHEEL,this.OnMouseWheel,!1,this)}OnMouseDown(t){if(this._bDragging=!1,this._bPanned=!1,t.button!=n.MouseEvent.RIGHT_CLICK_BUTTON){var i=this._callbackObj.GetRelativeMousePosition(t);this._mx=i.x,this._my=i.y,this._px=this._mx,this._py=this._my,this._bDown=!0,this._origPanX=this._callbackObj.getPanX(),this._origPanY=this._callbackObj.getPanY(),this._origZoom=this._callbackObj.getZoom(),this._bMomentumPanning&&(this._currTime=(new Date).getTime())}this._momentumTimer&&this._momentumTimer.isRunning()&&(this._momentumTimer.stop(),this._momentumTimer.reset())}OnMouseMove(t){var i=this._callbackObj.GetRelativeMousePosition(t);if(!(Math.abs(i.x-this._px)<=3&&Math.abs(i.y-this._py)<=3)){if(this._bDown){this._bDragging=!0;var s=(i=this._callbackObj.GetRelativeMousePosition(t)).x,e=i.y;if(t.ctrlKey){this._bZooming||(this._callback.call(this._callbackObj,n.EventFactory.newZoomEvent("dragZoomBegin")),this._bZooming=!0,this._callbackObj.SetElasticConstraints(!0));var a=this._py>=e?1:-1,o=this._origZoom*Math.pow(1+.01*a,Math.abs(this._py-e));this._callbackObj.isPanningEnabled()?this._callbackObj.zoomTo(o,this._px,this._py):this._callbackObj.zoomTo(o,null,null)}else this._handlePanMove(s,e);this._mx=s,this._my=e}this._callbackObj.setCursor(this._callbackObj.getCursor(this._bDown))}}OnMouseUp(t){this.PanZoomEnd(),super.OnMouseUp(t)}OnClick(t){(this._bDragging||this._bPanned)&&(this._bDragging=!1,this._bPanned=!1,n.EventManager.consumeEvent(t))}OnMouseOut(t){this._bDown&&(this._bPanning||this._bZooming)&&(t.relatedTarget&&null!=t.relatedTarget||this.OnMouseUp(t)),super.OnMouseOut(t)}OnMouseWheel(t){if(t.wheelDelta&&0!==t.wheelDelta&&this._callbackObj.isZoomingEnabled()){var i=this._callbackObj.getZoom();if(this._zoomAnimator){var s=this._zoomAnimator;this._zoomAnimator.stop(),i=this._callbackObj.getZoom(s),this._zoomAnimator=null}this._zoomAnimator=null;var e=t.wheelDelta,a=i*(1+this._callbackObj.getZoomIncr()*e/Math.abs(e)),o=this._callbackObj.GetRelativeMousePosition(t);t.stopPropagation(),t.preventDefault(),this._callbackObj.isPanningEnabled()?this._callbackObj.zoomTo(a,o.x,o.y,this._zoomAnimator):this._callbackObj.zoomTo(a,null,null,this._zoomAnimator),this._zoomAnimator&&(n.Playable.appendOnEnd(this._zoomAnimator,this._clearZoomAnimator,this),this._zoomAnimator.play())}}_clearZoomAnimator(){this._zoomAnimator=null}_handleMomentumStartTimer(){}_handleMomentumTimer(){var t=1-.04*this._momentumIterCount;t*=t;var n=this._momentumTimer.getInterval(),i=t*this._momentumXperMS*n,s=t*this._momentumYperMS*n;this._momentumDx+=i,this._momentumDy+=s;var e=this._origPanX+this._mx-this._px+this._momentumDx,a=this._origPanY+this._my-this._py+this._momentumDy;this._callbackObj.panTo(e,a);var o=!1;if(this._momentumIterCount>=24)o=!0;else{var h=this._callbackObj.getPanX(),r=this._callbackObj.getPanY(),m=this._pzc.getPanDir();(Math.abs(h-e)>Math.abs(i)&&"y"!=m||Math.abs(r-a)>Math.abs(s)&&"x"!=m)&&(o=!0)}o?(this._momentumTimer.stop(),this._momentumTimer.reset(),this._callbackObj.SetElasticConstraints(!1)):this._momentumIterCount++}HandleImmediateTouchStartInternal(t){this._callbackObj.isZoomingEnabled()&&this.TouchManager.processAssociatedTouchAttempt(t,"zoomTouch",this.ZoomStartTouch,this),this._callbackObj.isPanningEnabled()&&this.TouchManager.processAssociatedTouchAttempt(t,"panTouch",this.PanStartTouch,this)}HandleImmediateTouchMoveInternal(t){this._callbackObj.isZoomingEnabled()&&this.TouchManager.processAssociatedTouchMove(t,"zoomTouch"),this._callbackObj.isPanningEnabled()&&this.TouchManager.processAssociatedTouchMove(t,"panTouch"),(this._callbackObj.isZoomingEnabled()||this._callbackObj.isPanningEnabled())&&t.preventDefault()}HandleImmediateTouchEndInternal(t){this._callbackObj.isZoomingEnabled()&&this.TouchManager.processAssociatedTouchEnd(t,"zoomTouch"),this._callbackObj.isPanningEnabled()&&this.TouchManager.processAssociatedTouchEnd(t,"panTouch")}ZoomStartTouch(t,n){var i=this.TouchManager.getTouchIdsForObj("zoomTouch");i.length<=1&&(this.TouchManager.saveProcessedTouch(n.identifier,"zoomTouch",null,"zoomTouch","zoomTouch",this.ZoomMoveTouch,this.ZoomEndTouch,this),this._mx=n.pageX,this._my=n.pageY,this._px=this._mx,this._py=this._my,this._origPanX=this._callbackObj.getPanX(),this._origPanY=this._callbackObj.getPanY(),this._origZoom=this._callbackObj.getZoom(),this._origDist=null,i=this.TouchManager.getTouchIdsForObj("zoomTouch"),this._callbackObj.setCurrentTouchTargets(this.TouchManager.getStartTargetsByIds(i))),this._momentumTimer&&this._momentumTimer.isRunning()&&(this._momentumTimer.stop(),this._momentumTimer.reset())}ZoomMoveTouch(t,i){var s=this.TouchManager.getTouchIdsForObj("zoomTouch");if(2==s.length){var e=this.TouchManager.getMultiTouchData(s);if(e){this._bZooming||(this._bZooming=!0,this.TouchManager.blockTouchHold(),this._callback.call(this._callbackObj,n.EventFactory.newZoomEvent("dragZoomBegin"))),this._callbackObj.SetElasticConstraints(!0),null==this._origDist&&(this._origDist=e.dist-e.dz);var a=this._origZoom*(e.dist/this._origDist),o=this._pzc.getCtx().pageToStageCoords(e.cx,e.cy);this.hideTooltip(),this._callbackObj.setCurrentTouchTargets(this.TouchManager.getStartTargetsByIds(s)),this._callbackObj.zoomTo(a,o.x,o.y),this._callbackObj.panBy(e.dcx,e.dcy)}}}ZoomEndTouch(t,i){this._bZooming&&(this._origDist=null,this.TouchManager.unblockTouchHold(),this._handleZoomEnd());var s=this.TouchManager.getTouchIdsForObj("zoomTouch");this._callbackObj.setCurrentTouchTargets(this.TouchManager.getStartTargetsByIds(s)),0==s.length&&this._callback.call(this._callbackObj,n.EventFactory.newZoomEvent("zoomEnd",this._callbackObj.getZoom(),this._origZoom))}PanStartTouch(t,n){this._bZooming||this.TouchManager.getTouchIdsForObj("panTouch").length<=1&&(this.TouchManager.saveProcessedTouch(n.identifier,"panTouch",null,"panTouch","panTouch",this.PanMoveTouch,this.PanEndTouch,this),this._mx=n.pageX,this._my=n.pageY,this._px=this._mx,this._py=this._my,this._origPanX=this._callbackObj.getPanX(),this._origPanY=this._callbackObj.getPanY(),this._origZoom=this._callbackObj.getZoom(),this._bMomentumPanning&&(this._currTime=(new Date).getTime()));this._momentumTimer&&this._momentumTimer.isRunning()&&(this._momentumTimer.stop(),this._momentumTimer.reset())}PanMoveTouch(t,n){if(!this._bZooming&&1==this.TouchManager.getTouchIdsForObj("panTouch").length){var i=n.pageX,s=n.pageY;this._handlePanMove(i,s),this._mx=i,this._my=s}}PanEndTouch(t,n){!this._bZooming&&this._bPanning&&(this._handlePanEnd(),this.SetEventInfo(t,"panned",!0))}_handleZoomEnd(){this._callback.call(this._callbackObj,n.EventFactory.newZoomEvent("dragZoomEnd")),this._bZooming=!1,this._callbackObj.SetElasticConstraints(!1)}_handlePanMove(t,i){this._bPanning||(this._callback.call(this._callbackObj,n.EventFactory.newPanEvent("dragPanBegin")),this._bPanning=!0,this._callbackObj.SetElasticConstraints(!0),this._bMomentumPanning&&(this._arLastNMouseMoves=[])),this._callbackObj.panTo(this._origPanX+t-this._px,this._origPanY+i-this._py),this._bMomentumPanning&&(this._lastTime=this._currTime,this._currTime=(new Date).getTime(),this._momentumStartTimer?(this._momentumStartTimer.isRunning()&&this._momentumStartTimer.stop(),this._momentumStartTimer.reset()):this._momentumStartTimer=new n.Timer(this._context,this._MOMENTUM_START_TIMER_INTERVAL,this._handleMomentumStartTimer,this,1),this._arLastNMouseMoves.push({dt:this._currTime-this._lastTime,dx:t-this._mx,dy:i-this._my}),this._arLastNMouseMoves.length>5&&this._arLastNMouseMoves.splice(0,1),this._momentumStartTimer.start())}_handlePanEnd(){if(this._callback.call(this._callbackObj,n.EventFactory.newPanEvent("dragPanEnd")),this._bPanning=!1,this._bPanned=!0,this._momentumStartTimer&&this._momentumStartTimer.isRunning()){this._momentumStartTimer.stop(),this._momentumStartTimer.reset(),this._momentumTimer?this._momentumTimer.reset():this._momentumTimer=new n.Timer(this._context,this._MOMENTUM_START_TIMER_INTERVAL,this._handleMomentumTimer,this);for(var t=0,i=0,s=0,e=this._arLastNMouseMoves.length;this._arLastNMouseMoves.length>0;){var a=this._arLastNMouseMoves.pop();t+=a.dt,i+=a.dx,s+=a.dy}this._arLastNMouseMoves=null,this._momentumXperMS=i/t,this._momentumYperMS=s/t,this._momentumTimer.setInterval(Math.ceil(t/e)),this._momentumIterCount=1,this._momentumDx=0,this._momentumDy=0,this._pzc.isPanningEnabled()&&this._momentumTimer.start()}else this._callbackObj.SetElasticConstraints(!1)}PanZoomEnd(){this._bDown=!1,this._bDragging=!1,this._bPanning&&this._handlePanEnd(),this._bZooming&&this._handleZoomEnd(),this._callbackObj.setCursor(this._callbackObj.getCursor(this._bDown))}GetTouchResponse(){return this._pzc.isPanningEnabled()||this._pzc.isZoomingEnabled()?n.EventManager.TOUCH_RESPONSE_TOUCH_HOLD:n.EventManager.TOUCH_RESPONSE_AUTO}StoreInfoByEventType(t){return"panned"!=t&&super.StoreInfoByEventType(t)}}class s extends n.Container{constructor(t,e,a,o){super(t),this.DEFAULT_PAN_INCREMENT=15,this.DEFAULT_ZOOM_INCREMENT=.05,this.DEFAULT_ANIMATION_DURATION=.5,this._view=o,this._ww=e,this._hh=a,this._px=0,this._py=0,this._mx=0,this._my=0,this._minPanX=null,this._maxPanX=null,this._minPanY=null,this._maxPanY=null,this._minZoom=.1,this._maxZoom=1,this._panIncrement=this.DEFAULT_PAN_INCREMENT,this._zoomIncrement=this.DEFAULT_ZOOM_INCREMENT,this._zoomToFitPadding=s.DEFAULT_PADDING,this._bPanningEnabled=!0,this._panDirection="auto",this._bZoomingEnabled=!0,this._bZoomToFitEnabled=!0,this._backgroundPane=new n.Rect(this.getCtx(),0,0,this._ww,this._hh),this.addChild(this._backgroundPane),this._backgroundPane.setInvisibleFill(),this._contentPane=new n.Container(this.getCtx()),this.addChild(this._contentPane),this._contentPane.setMatrix(new n.Matrix),this._animationDuration=this.DEFAULT_ANIMATION_DURATION,this._eventManager=new i(t,this.FireListener,this),this._eventManager.addListeners(this),this._clipIdSuffix=1,this.SetClipRect(e,a),this._bElasticConstraints=!1,this._elasticConstraintsAnim=null}setSize(t,n,i){this._ww=t,this._hh=n,i||(this._backgroundPane.setWidth(t),this._backgroundPane.setHeight(n),this.SetClipRect(t,n))}getSize(){return new n.Dimension(this._ww,this._hh)}SetClipRect(t,i){var s=new n.ClipPath("pzc");s.addRect(this.getTranslateX(),this.getTranslateY(),t,i),this.setClipPath(s)}getContentPane(){return this._contentPane}setContentPane(t){this._contentPane=t}getBackgroundPane(){return this._backgroundPane}getContentPaneMatrix(t){if(t){var n=t.getDestVal(this._contentPane,this._contentPane.getMatrix);if(n)return n}return this._contentPane.getMatrix()}getZoom(t){return this.getContentPaneMatrix(t).getA()}getPanX(t){return this.getContentPaneMatrix(t).getTx()}getPanY(t){return this.getContentPaneMatrix(t).getTy()}setZoomToFitPadding(t){this._zoomToFitPadding=t}getZoomToFitPadding(){return this._zoomToFitPadding}panBy(t,i,s,e){if(this.isPanningEnabled()){var a=this.getPanX(s),o=this.getPanY(s),h="y"==this.getPanDir()?a:this.ConstrainPanX(a+t),r="x"==this.getPanDir()?o:this.ConstrainPanY(o+i),m=h-a,_=r-o,l=null;s&&(l=s.getDestVal(this._contentPane,this._contentPane.getMatrix)),l||(l=this._contentPane.getMatrix()),l=l.translate(m,_);var c=this,g=()=>{c.FirePanEvent("panning",h,r,a,o,s)},u=()=>{c.FirePanEvent("panned",h,r,a,o,s)};s?(s.addProp(n.Animator.TYPE_MATRIX,this._contentPane,this._contentPane.getMatrix,this._contentPane.setMatrix,l),n.Playable.prependOnInit(s,g),n.Playable.appendOnEnd(s,u),e&&n.Playable.appendOnEnd(s,e)):(g(),this._contentPane.setMatrix(l),u(),e&&e())}}panTo(t,n,i){if(this.isPanningEnabled()){var s=t-this.getPanX(i),e=n-this.getPanY(i);this.panBy(s,e,i)}}zoomBy(t,i,s,e){if(this.isZoomingEnabled()){i||0===i||(i=this._ww/2),s||0===s||(s=this._hh/2);var a=this.getZoom(e),o=this.ConstrainZoom(a*t),h=o/a,r=null;e&&(r=e.getDestVal(this._contentPane,this._contentPane.getMatrix)),r||(r=this._contentPane.getMatrix()),r=r.scale(h,h,i,s);var m=this.ConstrainPanX(r.getTx())-r.getTx(),_=this.ConstrainPanY(r.getTy())-r.getTy();this.FireZoomEvent("adjustPanConstraints",o,a,e,i,s,m,_),m=this.ConstrainPanX(r.getTx())-r.getTx(),_=this.ConstrainPanY(r.getTy())-r.getTy(),r=r.translate(m,_);var l=this,c=()=>{l.FireZoomEvent("zooming",o,a,e,i,s,m,_)},g=()=>{l.FireZoomEvent("zoomed",l.getZoom(),a,e,i,s,m,_)};e?(e.addProp(n.Animator.TYPE_MATRIX,this._contentPane,this._contentPane.getMatrix,this._contentPane.setMatrix,r),n.Playable.prependOnInit(e,c),n.Playable.appendOnEnd(e,g)):(c(),this._contentPane.setMatrix(r),g())}}zoomTo(t,n,i,s){if(this.isZoomingEnabled()){var e=t/this.getZoom(s);this.zoomBy(e,n,i,s)}}center(t,n){var i=this.isPanningEnabled(),s=this.getPanDir();this.setPanningEnabled(!0),this.setPanDir("auto");var e=n;e||(e=this._contentPane.getDimensions());var a=(e.x+e.w/2)*this.getZoom(),o=(e.y+e.h/2)*this.getZoom(),h=this._ww/2-a,r=this._hh/2-o;this.panTo(h,r,t),this.setPanningEnabled(i),this.setPanDir(s)}zoomToFit(t,i){if(this.isZoomToFitEnabled()){var s=this.isPanningEnabled(),e=this.getPanDir(),a=this.isZoomingEnabled();this.setPanningEnabled(!0),this.setPanDir("auto"),this.setZoomingEnabled(!0);try{var o=i||this._contentPane.getDimensions();if(!o)return;var h=(this._ww-2*this._zoomToFitPadding)/o.w,r=(this._hh-2*this._zoomToFitPadding)/o.h,m=Math.min(h,r);m=this.ConstrainZoom(m);var _=(o.x+o.w/2)*m,l=(o.y+o.h/2)*m,c=this._ww/2-_,g=this._hh/2-l,u=this.getZoom(t),b=this,d=()=>{b.FireZoomEvent("zoomToFitBegin",null,null,t)},P=()=>{b.FireZoomEvent("zoomToFitEnd",b.getZoom(),u,t)};t?n.Playable.prependOnInit(t,d):d(),this.zoomTo(m,0,0,t),this.panTo(c,g,t),t?n.Playable.appendOnEnd(t,P):P()}finally{this.setPanningEnabled(s),this.setPanDir(e),this.setZoomingEnabled(a)}}}calcZoomToFitScale(t){t||(t=this._contentPane.getDimensions());var n=(this._ww-2*this._zoomToFitPadding)/t.w,i=(this._hh-2*this._zoomToFitPadding)/t.h,s=Math.min(n,i);return s=this.ConstrainZoom(s)}calcZoomToFitBounds(){var t=this._contentPane.getDimensions();return t.x-=this._zoomToFitPadding,t.y-=this._zoomToFitPadding,t.w+=2*this._zoomToFitPadding,t.h+=2*this._zoomToFitPadding,t}getViewport(){var t=this.localToStage(new n.Point(0,0)),i=this.localToStage(new n.Point(this._ww,this._hh)),s=this.getContentPane().stageToLocal(t),e=this.getContentPane().stageToLocal(i);return new n.Rectangle(s.x,s.y,e.x-s.x,e.y-s.y)}SetElasticConstraints(t){if(this._bElasticConstraints=t,t)this._elasticConstraintsAnim&&(this._elasticConstraintsAnim.isRunning()&&this._elasticConstraintsAnim.stop(),this._elasticConstraintsAnim=null);else{var i=this.getPanX(),s=this.getPanY(),e=this.getZoom();this._bElasticPan=i!=this.ConstrainPanX(i)||s!=this.ConstrainPanY(s),this._bElasticZoom=e!=this.ConstrainZoom(e),(this._bElasticPan||this._bElasticZoom)&&(this._elasticConstraintsAnim=new n.Animator(this.getCtx(),.4),this._elasticConstraintsAnim.setEasing(n.Easing.cubicOut),this._bElasticZoom&&this.zoomBy(1,.5*this._ww,.5*this._hh,this._elasticConstraintsAnim),this._bElasticPan&&this.panBy(0,0,this._elasticConstraintsAnim),n.Playable.appendOnEnd(this._elasticConstraintsAnim,this._elasticConstraintsAnimOnEnd,this),this._bElasticPan&&this.FirePanEvent("elasticAnimBegin",null,null,null,null,this._elasticConstraintsAnim),this._bElasticZoom&&this.FireZoomEvent("elasticAnimBegin",null,null,null,null,this._elasticConstraintsAnim),this._elasticConstraintsAnim.play())}}IsElasticConstraints(){return this._bElasticConstraints}_elasticConstraintsAnimOnEnd(){this._elasticConstraintsAnim=null,this._bElasticPan&&this.FirePanEvent("elasticAnimEnd"),this._bElasticZoom&&this.FireZoomEvent("elasticAnimEnd")}_panDampingFunc(t,n){var i=.01*n;return Math.sqrt(4*i*t)}_zoomDampingFunc(t,n){var i=.002*n;return Math.sqrt(4*i*t)}ConstrainPanX(t){var n,i=t;return null!=this._minPanX&&i<this._minPanX&&(this.IsElasticConstraints()?(n=this._minPanX-i,i=this._minPanX-this._panDampingFunc(n,this._ww)):i=this._minPanX),null!=this._maxPanX&&i>this._maxPanX&&(this.IsElasticConstraints()?(n=i-this._maxPanX,i=this._maxPanX+this._panDampingFunc(n,this._ww)):i=this._maxPanX),i}ConstrainPanY(t){var n,i=t;return null!=this._minPanY&&i<this._minPanY&&(this.IsElasticConstraints()?(n=this._minPanY-i,i=this._minPanY-this._panDampingFunc(n,this._hh)):i=this._minPanY),null!=this._maxPanY&&i>this._maxPanY&&(this.IsElasticConstraints()?(n=i-this._maxPanY,i=this._maxPanY+this._panDampingFunc(n,this._hh)):i=this._maxPanY),i}ConstrainZoom(t){var n,i=Math.max(0,t);return this._minZoom&&i<this._minZoom&&(this.IsElasticConstraints()?(n=this._minZoom-i,i=this._minZoom-this._zoomDampingFunc(n,this._maxZoom-this._minZoom)):i=this._minZoom),this._maxZoom&&i>this._maxZoom&&(this.IsElasticConstraints()?(n=i-this._maxZoom,i=this._maxZoom+this._zoomDampingFunc(n,this._maxZoom-this._minZoom)):i=this._maxZoom),i}static RoundFloatForCompare(t){return Math.round(1e5*t)}GetRelativeMousePosition(t){return this.getCtx().pageToStageCoords(t.pageX,t.pageY)}FirePanEvent(t,i,s,e,a,o){var h=n.EventFactory.newPanEvent(t,i,s,e,a,o);this.FireListener(h)}FireZoomEvent(t,i,s,e,a,o,h,r){var m=n.EventFactory.newZoomEvent(t,i,s,e,new n.Point(a,o),h,r);return this.FireListener(m),m}zoomAndCenter(){this.FireZoomEvent("zoomAndCenter")}getNextZoomLevel(t){var n=t;return(n+=this.getZoomIncr())>this.getMaxZoom()&&(n=this.getMaxZoom()),n}getPrevZoomLevel(t){var n=t;return(n-=this.getZoomIncr())<this.getMinZoom()&&(n=this.getMinZoom()),n}getZoomIncr(){return this._zoomIncrement}getPanIncr(){return this._panIncrement}setMinZoom(t){this._minZoom=t}getMinZoom(){return this._minZoom}setMaxZoom(t){t<0&&(t=1),this._maxZoom=t}getMaxZoom(){return this._maxZoom}setMinPanX(t){this._minPanX=t}getMinPanX(){return this._minPanX}setMaxPanX(t){this._maxPanX=t}getMaxPanX(){return this._maxPanX}setMinPanY(t){this._minPanY=t}getMinPanY(){return this._minPanY}setMaxPanY(t){this._maxPanY=t}getMaxPanY(){return this._maxPanY}setAnimDur(t){this._animationDuration=t}getAnimDur(){return this._animationDuration}setPanningEnabled(t){this._bPanningEnabled=t}isPanningEnabled(){return this._bPanningEnabled}setPanDir(t){this._panDirection=t}getPanDir(){return this._panDirection}setZoomingEnabled(t){this._bZoomingEnabled=t}isZoomingEnabled(){return this._bZoomingEnabled}setZoomToFitEnabled(t){this._bZoomToFitEnabled=t}isZoomToFitEnabled(){return this._bZoomToFitEnabled}setCurrentTouchTargets(t){this._currTargets=t}getCurrentTouchTargets(){return this._currTargets}resetTouchTargets(){n.Agent.isTouchDevice()&&(this._currTargets=null,this._eventManager.TouchManager.reset())}panZoomEnd(){this._eventManager.PanZoomEnd()}setInteractionEnabled(t){t?this._eventManager.addListeners(this):this._eventManager.removeListeners(this)}destroy(){this._elasticConstraintsAnim&&(this._elasticConstraintsAnim.stop(!0),this._elasticConstraintsAnim=null),this._eventManager&&(this._eventManager.removeListeners(this),this._eventManager.destroy(),this._eventManager=null),this.setClipPath(null),super.destroy(this)}getCursor(t){return this._bPanningEnabled?t?n.ToolkitUtils.getGrabbingCursor():n.ToolkitUtils.getGrabCursor():"inherit"}}s.DEFAULT_PADDING=20;class e extends n.KeyboardHandler{constructor(t,n){super(n),this._comp=t}processKeyDown(t){var i=t.keyCode,s=this._comp.getPanZoomCanvas();if(i==n.KeyboardEvent.PAGE_UP)t.ctrlKey||t.shiftKey?s.panBy(s.getPanIncr(),0):s.panBy(0,s.getPanIncr()),t.preventDefault();else if(i==n.KeyboardEvent.PAGE_DOWN)t.ctrlKey||t.shiftKey?s.panBy(-s.getPanIncr(),0):s.panBy(0,-s.getPanIncr()),t.preventDefault();else if(n.KeyboardEvent.isEquals(t)||n.KeyboardEvent.isPlus(t))s.zoomTo(s.getZoom()+s.getZoomIncr());else if(n.KeyboardEvent.isMinus(t)||n.KeyboardEvent.isUnderscore(t))s.zoomTo(s.getZoom()-s.getZoomIncr());else{if(i!=n.KeyboardEvent.ZERO&&i!=n.KeyboardEvent.NUMPAD_ZERO||t.ctrlKey||t.shiftKey)return super.processKeyDown(t);s.zoomToFit()}}}class a extends n.BaseComponent{constructor(t,i,s){super(t,i,s),this._bSupportsVectorEffects=!(("ie"===n.Agent.browser||"edge"===n.Agent.browser)&&n.Agent.version<=11),this._resourcesMap=null,this._panAnimator=null,this._panningInterrupted=!1}getPanZoomCanvas(){return this._panZoomCanvas}render(t,n,i){this.Width=n,this.Height=i,this._isResize=!t,this.IsResize()&&!this.getPanZoomCanvas()||(this.PreRender(),this.IsResize()||this.SetOptions(t),this.Render(t,n,i),this.UpdateAriaAttributes())}supportsVectorEffects(){return this._bSupportsVectorEffects}HandlePanEvent(t){}HandleZoomEvent(t){}IsResize(){return this._isResize}PreRender(){}Render(){this.IsResize()?this._panZoomCanvas.setSize(this.getWidth(),this.getHeight()):(this._panZoomCanvas&&(this.removeChild(this._panZoomCanvas),this._panZoomCanvas=null),this._panZoomCanvas=new s(this.getCtx(),this.getWidth(),this.getHeight(),this),this._panZoomCanvas.addEvtListener("dvtPan",this.HandlePanEvent,!1,this),this._panZoomCanvas.addEvtListener("dvtZoom",this.HandleZoomEvent,!1,this),this.addChild(this._panZoomCanvas));var t=new n.ClipPath("comp");t.addRect(this.getTranslateX(),this.getTranslateY(),this.getWidth(),this.getHeight()),this.setClipPath(t)}SetOptions(t){this.Options=this.Defaults?this.Defaults.calcOptions(t):t}destroy(){this._panZoomCanvas&&(this._panZoomCanvas.destroy(),this._panZoomCanvas=null),super.destroy()}ensureObjInViewport(t,i){if(this._panZoomCanvas.isPanningEnabled()){this._panAnimator&&(this._panningInterrupted=!0,this._panAnimator.stop());var s=this.Width,e=this.Height,a=i.getKeyboardBoundingBox(this.getCtx().getStage()),o=new n.Rectangle(0,0,s,e);if(!o.getUnion(a).equals(o)){var h=0,r=0,m=a.w,_=a.h,l=a.x,c=a.y;m<=s?l<0?h=l:l+m>s&&(h=l+m-s):h=l+.5*m-.5*s,_<=e?c<0?r=c:c+_>e&&(r=c+_-e):r=c+.5*_-.5*e;var g=new n.Animator(this.getCtx(),this.getAnimDur());this._panAnimator=g;var u=this;this.getPanZoomCanvas().panBy(-h,-r,g,()=>{u._panAnimator=null,u.getEventManager().showFocusEffect(t,i),u._panningInterrupted=!1}),g.play()}}}isPanning(){return null!=this._panAnimator||this._panningInterrupted}}t.PanZoomCanvas=s,t.PanZoomCanvasEventManager=i,t.PanZoomCanvasKeyboardHandler=e,t.PanZoomComponent=a,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ojdvt-panzoomcanvas.js.map