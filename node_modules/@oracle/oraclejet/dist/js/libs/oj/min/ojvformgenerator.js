/**
 * @license
 * Copyright (c) 2014, 2022, Oracle and/or its affiliates.
 * Licensed under The Universal Permissive License (UPL), Version 1.0
 * as shown at https://oss.oracle.com/licenses/upl/
 * @ignore
 */
define(["exports","preact","ojs/ojthemeutils","ojs/ojlabel","ojs/ojcustomelement-utils","ojs/ojdomutils"],function(t,e,o,l,s,n){"use strict";function a(t){const l=function(t,e){let l=t;if(e>1){const s=/^([+-]?(?:\d+|\d*\.\d+))([a-z]*|%)$/,n=t.match(s),a=parseFloat(n[1]);switch(n[2]){case"vw":case"vmin":case"vmax":case"%":if(e>1){let s=o.parseJSONFromFontFamily("oj-form-layout-option-defaults").columnGap;l="calc((("+t+" / "+e+") - (("+s+" * ("+(e-1)+") * "+a/e/100+")))"}}}return l}(t.labelWidth,t.colspan),s="calc(100% - "+l+")",n={flexGrow:"0",flexShrink:"0",flexBasis:l,width:l,maxWidth:l},a={flexGrow:"1",flexShrink:"1",flexBasis:s,width:s,maxWidth:s};return Array.isArray(t.children)||(t.children.props.labelEdge="provided"),e.h(e.Fragment,null,e.h("div",{class:"oj-formlayout-inline-label",style:n},e.h("oj-label",{for:t.forid},t.labelText)),e.h("div",{class:"oj-formlayout-inline-value",style:a},t.children))}function r(t){return Array.isArray(t.children)||(t.children.props.labelEdge="provided"),e.h(e.Fragment,null,e.h("oj-label",{for:t.forid},t.labelText),t.children)}function i(t){let o;if(t.children){const l=!Array.isArray(t.children);return l&&(o=s.ElementUtils.getUniqueId(t.children.props.id)),"start"===t.labelEdge?e.h(a,Object.assign({forid:o},t)):"top"===t.labelEdge?e.h(r,Object.assign({forid:o},t)):(l&&("inside"===t.labelEdge?(t.children.props.labelEdge=t.labelEdge,t.children.props.labelHint=t.labelText):t.children.props.labelEdge="none"),e.h(e.Fragment,null,t.children))}return null}class m extends e.Component{render(t){let o="oj-flex-item";const l=this._getFullFlexItemWidth(this.props.colspan,this.props.totalColumns);let s={flexGrow:"1",flexShrink:"1",flexBasis:l,width:l,maxWidth:l};return"start"==this.props.labelEdge&&(s.display="flex"),"formLayout"===this.props.contentType&&(o+=" oj-formlayout-nested-formlayout"),e.h("div",{class:o,style:s,key:t.cellKey},e.h(i,{labelText:this.props.labelText,labelEdge:this.props.labelEdge,labelWidth:this.props.labelWidth,colspan:this.props.colspan,totalColumns:this.props.totalColumns},this.props.children))}_getFullFlexItemWidth(t,e){if(t===e)return"100%";let l=(o.parseJSONFromFontFamily("oj-form-layout-option-defaults")||{}).columnGap,s=(this.props.totalColumns,"calc(((100% / "+e+") - (("+l+" * ("+(e-1)+") / "+e+")))");return t>1&&(s+=" * "+t+" + ("+l+" * "+(t-1)+")"),s+=")",s}}m.defaultProps={colspan:1,totalColumns:1,labelEdge:"inside",labelWidth:"33%",labelText:""};class u extends e.Component{render(t){this._columns=t.columns>0?t.columns:t.maxColumns;const o="oj-form-layout oj-formlayout-max-cols-"+this._columns,l=this._getColumnFormContent(t.formControls,t.columns);return e.h("div",{class:o},l)}_getColumnFormContent(t,l){let s,n,a,r=[];for(const l of t)n="function"==typeof l.content?l.content():l.content,a=l.labelEdge,a||(this._themeDefault||(this._themeDefault=o.parseJSONFromFontFamily("oj-form-layout-option-defaults")||{}),a=this._themeDefault.labelEdge),s=e.h(m,{totalColumns:1,labelText:l.labelText,labelEdge:a,labelWidth:l.labelWidth,contentType:l.contentType,cellKey:l.key},n),r.push(e.h("div",{class:"oj-flex","data-oj-internal":!0},s));const i=this._getColumnStyling(l);return e.h("div",{class:i.formClassName,style:i.formStyle,"data-oj-context":!0,"data-oj-internal":!0},r)}_getColumnStyling(t){let e="oj-form";return this.props.readonly||(e+=" oj-enabled"),"efficient"===this.props.userAssistanceDensity&&(e+=" oj-efficient"),"truncate"===this.props.labelWrapping&&(e+=" oj-formlayout-labels-nowrap"),t>0&&(e+=" oj-form-layout-no-min-column-width"),e+=" oj-form-cols",{formClassName:e,formStyle:{columnCount:this._columns,webkitColumnCount:this._columns,MozColumnCount:this._columns}}}}u.defaultProps={colspanWrap:"nowrap",formControls:[],labelWrapping:"wrap",columns:0,maxColumns:1,readonly:!1,userAssistanceDensity:"efficient"};class c extends e.Component{constructor(){super(...arguments),this.setFormDivRef=t=>{this.formDivRef=t},this.state={availableColumns:0},this._updateAvailableColumns=()=>{if(0===this._calculateColumns(0)){const t=this.formDivRef,e=t.class;t.class="oj-form-layout";const o=this._calculateAvailableColumns(t);t.class=e,this.state.availableColumns!==o&&this.setState({availableColumns:o})}}}render(t){const o="oj-form-layout oj-formlayout-max-cols-"+(t.columns>0?t.columns+" oj-form-layout-no-min-column-width":t.maxColumns),l=this._getRowFormContent(this.props.formControls);return e.h("div",{class:o,ref:this.setFormDivRef},l)}componentDidMount(){this._updateAvailableColumns(),n.addResizeListener(this.formDivRef,this._updateAvailableColumns,25)}componentDidUpdate(){this._updateAvailableColumns()}componentWillUnmount(){n.removeResizeListener(this.formDivRef,this._updateAvailableColumns)}_calculateAvailableColumns(t){let e=Math.max(this.props.maxColumns,1),o=parseFloat(window.getComputedStyle(t.querySelector(".oj-form")).columnWidth);if(!isNaN(o)){let t=this.formDivRef.getBoundingClientRect().width;e=Math.max(Math.floor(t/o),1)}return e}_calculateColumns(t){let e=Math.max(this.props.maxColumns,1);const o=this.props.columns;return o>0?e=o:e>1&&t<e&&(e=t),e}_getRowFormContent(t){let l,s=[];const n=this._calculateColumns(this.state.availableColumns);0===n&&(t=[]);let a,r,i,u,c=0,p=!1;for(const d of t){if(a=1,r=n,i="function"==typeof d.content?d.content():d.content,c%n==0&&(l&&this._addRowToForm(s,l,c),l=[]),d.colspan&&d.colspan>1){const t=c%n;let e=n-t;a=Math.floor(d.colspan),"wrap"===this.props.colspanWrap&&e<a&&t>0&&(this._addRowToForm(s,l,c),c+=e,l=[],e=n),a=Math.min(a,e),p=n>1}u=d.labelEdge,u||(this._themeDefault||(this._themeDefault=o.parseJSONFromFontFamily("oj-form-layout-option-defaults")||{}),u=this._themeDefault.labelEdge),l.push(e.h(m,{colspan:a,totalColumns:r,labelText:d.labelText,labelEdge:u,labelWidth:d.labelWidth,contentType:d.contentType,cellKey:d.key},i)),c+=a,c%n!=0&&this._addColumnGutter(l)}this._addRowToForm(s,l,c);const d=this._getRowStyling(p);return e.h("div",{class:d.formClassName,style:d.formStyle,"data-oj-context":!0,"data-oj-internal":!0},s)}_addColumnGutter(t){t.push(e.h("div",{class:"oj-formlayout-column-gutter"}))}_addRowToForm(t,o,l){this._addPaddingCells(o,l),t.push(e.h("div",{class:"oj-flex","data-oj-internal":!0},o))}_addPaddingCells(t,o){const l=this._calculateColumns(this.state.availableColumns)||this.props.maxColumns,s=o%l;if(t&&s>0)for(let o=s;o<l;o++)o!==s&&this._addColumnGutter(t),t.push(e.h(m,{colspan:1,totalColumns:l,labelEdge:"none"}))}_getRowStyling(t){let e="oj-form";this.props.readonly||(e+=" oj-enabled"),"efficient"===this.props.userAssistanceDensity&&(e+=" oj-efficient"),"truncate"===this.props.labelWrapping&&(e+=" oj-formlayout-labels-nowrap"),t&&(e+=" oj-form-control-full-width"),e+=" oj-form-cols";return e+=" oj-formlayout-form-across",{formClassName:e,formStyle:{columnCount:1,webkitColumnCount:1,MozColumnCount:1}}}}c.defaultProps={colspanWrap:"nowrap",formControls:[],labelWrapping:"wrap",columns:0,maxColumns:1,readonly:!1,userAssistanceDensity:"efficient"};var p=function(t,e){var o={};for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&e.indexOf(l)<0&&(o[l]=t[l]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(l=Object.getOwnPropertySymbols(t);s<l.length;s++)e.indexOf(l[s])<0&&Object.prototype.propertyIsEnumerable.call(t,l[s])&&(o[l[s]]=t[l[s]])}return o};class d extends e.Component{render(t){const{direction:o}=t,l=p(t,["direction"]);return"column"===o?e.h(u,Object.assign({},l)):e.h(c,Object.assign({},l))}}d.defaultProps={colspanWrap:"nowrap",direction:"row",formControls:[],labelWrapping:"wrap",columns:0,maxColumns:1,readonly:!1,userAssistanceDensity:"efficient"},t.VFormGenerator=d,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ojvformgenerator.js.map